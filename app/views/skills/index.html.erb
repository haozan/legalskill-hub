<div class="container-xl mx-auto px-6 py-12">
  <!-- Header -->
  <div class="mb-12">
    <h1 class="section-title">实战技能市场</h1>
    <p class="section-subtitle">
      专业律师上传的实用技能包，包含文档模板、AI提示词、办案指南，每个技能仅需 <span class="font-bold text-primary">¥99</span>。
    </p>
  </div>

  <!-- Search & Filter -->
  <div class="mb-8">
    <%= form_with url: skills_path, method: :get, class: "space-y-4" do |f| %>
      <div class="flex flex-col md:flex-row gap-4">
        <!-- Search -->
        <div class="flex-1">
          <div class="relative">
            <%= f.text_field :search, placeholder: "搜索技能名称或描述...", class: "form-input w-full pl-12", value: params[:search] %>
            <div class="absolute left-4 top-1/2 -translate-y-1/2 text-muted">
              <%= lucide_icon "search", class: "w-5 h-5" %>
            </div>
          </div>
        </div>
        
        <!-- Category Filter -->
        <div class="md:w-64">
          <%= f.select :category, 
                options_for_select([["全部分类", ""]] + @categories.map { |c| [c.name, c.slug] }, params[:category]),
                {}, 
                class: "form-select w-full" %>
        </div>
        
        <button type="submit" class="btn-primary px-6">
          <%= lucide_icon "filter", class: "w-5 h-5 inline" %>
          <span class="ml-2">筛选</span>
        </button>
      </div>
    <% end %>
  </div>

  <!-- Category Pills -->
  <div class="flex flex-wrap gap-3 mb-12">
    <%= link_to "全部技能", skills_path, class: "category-pill #{params[:category].blank? ? 'active' : ''}" %>
    <% @categories.each do |category| %>
      <%= link_to category.name, skills_path(category: category.slug), class: "category-pill #{params[:category] == category.slug ? 'active' : ''}" %>
    <% end %>
  </div>

  <!-- Skills Grid -->
  <% if @skills.any? %>
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
      <% @skills.each do |skill| %>
        <div class="skill-card">
          <div class="card-body">
            <div class="flex items-start justify-between mb-4">
              <span class="skill-card-badge"><%= skill.category.name %></span>
              <div class="flex items-center gap-1 text-secondary text-sm">
                <%= lucide_icon "star", class: "w-4 h-4 fill-current" %>
                <span class="font-semibold"><%= number_with_precision(skill.rating, precision: 1) %></span>
              </div>
            </div>
            
            <%= link_to skill_path(skill), class: "block" do %>
              <h3 class="font-serif text-2xl font-semibold text-primary mb-3 hover:underline"><%= skill.title %></h3>
            <% end %>
            
            <p class="text-secondary text-sm mb-6 line-clamp-3">
              <%= skill.description %>
            </p>
            
            <div class="flex items-center gap-4 mb-6 text-sm text-muted">
              <div class="flex items-center gap-2">
                <%= lucide_icon "file-text", class: "w-4 h-4" %>
                <span><%= skill.template_count %>个模板</span>
              </div>
              <div class="flex items-center gap-2">
                <%= lucide_icon "download", class: "w-4 h-4" %>
                <span><%= skill.download_count %>次</span>
              </div>
            </div>
            
            <div class="flex items-center justify-between pt-4 border-t border-border">
              <div class="flex items-center gap-2 text-sm text-muted">
                <%= lucide_icon "user", class: "w-4 h-4" %>
                <span><%= skill.author_name %></span>
              </div>
              <div class="flex items-center gap-2">
                <span class="text-2xl font-bold font-serif text-primary">¥<%= number_with_precision(skill.price, precision: 0) %></span>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>

    <!-- Pagination -->
    <div class="flex justify-center">
      <%= paginate @skills, theme: 'twitter-bootstrap-4', pagination_class: "pagination justify-content-center" %>
    </div>
  <% else %>
    <div class="text-center py-16">
      <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-surface-elevated mb-4">
        <%= lucide_icon "search-x", class: "w-8 h-8 text-muted" %>
      </div>
      <p class="text-xl text-secondary">暂无符合条件的技能</p>
      <p class="text-sm text-muted mt-2">请尝试调整搜索条件或浏览其他分类</p>
      <%= link_to "查看全部技能", skills_path, class: "btn-primary mt-6 inline-block" %>
    </div>
  <% end %>
</div>
